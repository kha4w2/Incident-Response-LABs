# Malware Containment via AppLocker Path-Based Policy Report (File System-Level Containment Implementation)

## Introduction
This report documents a practical containment procedure implemented during a simulated incident response exercise. The focus was on utilizing Windows native security controls—specifically AppLocker—to isolate and prevent execution of potentially malicious files from a suspicious directory. This approach demonstrates a targeted containment strategy that balances security with operational continuity.

## Objective
To implement and validate a path-based application containment mechanism using AppLocker, effectively preventing execution of unauthorized executables from a designated suspicious folder while maintaining normal system functionality elsewhere.

<img width="1068" height="793" alt="15" src="https://github.com/user-attachments/assets/09e6aa25-a041-4e61-8fbb-d3e56c461bf2" />


## Containment Implementation Procedure

### **Step 1 — Creating a Suspicious Folder for Malware Containment Testing**
A new directory named **`C:\Test`** was created to simulate a malicious payload location. An executable file was placed inside the folder to serve as a test artifact representing the suspected malware.

**Path Used:** `C:\Test`
**Test Artifact:** `SuspiciousExecutable.exe`

### **Step 2 — Launching the Local Group Policy Editor to Configure AppLocker Policies**
The **Local Group Policy Editor** was opened using `gpedit.msc` to begin configuring Application Control Policies (AppLocker) required for blocking executable files within the suspicious directory.

<img width="1031" height="772" alt="2" src="https://github.com/user-attachments/assets/1c5e1f9d-f15d-4489-8492-51945f55001a" />


**Command Used:** `gpedit.msc`

### **Step 3 — Navigating to AppLocker Policy Configuration**


<img width="951" height="462" alt="image" src="https://github.com/user-attachments/assets/0a23475f-a35f-4ea3-991f-fc41a133f1d8" />


Navigated through the Local Group Policy Editor to access **Application Control Policies → AppLocker**, where executable restrictions were created to block malicious file execution.

**Navigation Path:**
```
Computer Configuration
 → Windows Settings
   → Security Settings
     → Application Control Policies
       → AppLocker
```

### **Step 4 — Opening Services Console to Enable Application Identity Service**


<img width="1052" height="770" alt="4" src="https://github.com/user-attachments/assets/46d5b7b5-4432-4d9c-accb-6517d8fed867" />

<img width="1062" height="767" alt="5" src="https://github.com/user-attachments/assets/f093fe53-434c-45c5-9dc0-288ba59d5a6f" />



The **Services Management Console** was opened using `services.msc` to start the *Application Identity* service, which is required for AppLocker enforcement.

**Command Used:** `services.msc`

### **Step 5 — Enable and Start Application Identity Service (AppIDSvc)**

<img width="1022" height="417" alt="8" src="https://github.com/user-attachments/assets/7b18d833-dd0b-4d3a-bc2a-87b9d525d2a1" />

The *Application Identity* service was enabled and set to start automatically. AppLocker cannot enforce any rules unless AppIDSvc is running.

**Commands Used:**
```powershell
sc.exe stop AppIDSvc
sc.exe config AppIDSvc start= auto
sc.exe start AppIDSvc
```

### **Step 6 — Configure Rule Permissions**

<img width="948" height="790" alt="9" src="https://github.com/user-attachments/assets/c9c9a750-d5dd-462d-a13a-320c9b677c24" />

Defined the action (Allow) and specified the user or group (Everyone) the AppLocker rule would apply to, establishing the baseline control before defining the matching condition.

### **Step 7 — Selecting the Rule Condition Type**

<img width="773" height="648" alt="10" src="https://github.com/user-attachments/assets/38aaf832-b0dc-498d-99d5-5591b5b27c35" />

<img width="772" height="657" alt="11" src="https://github.com/user-attachments/assets/c084ab3e-e9f1-4004-a662-be110391c83a" />



Determined how AppLocker would identify the executable to control—by publisher, file path, or file hash—to accurately target the intended application. Path condition was selected.

### **Step 8 — Reviewing Executable Rules Overview**

<img width="1032" height="772" alt="12" src="https://github.com/user-attachments/assets/1b73e3d3-df3d-4bd4-84b2-5fec3c9775d2" />

Verified that the new AppLocker rule targeting `C:\Test` appeared alongside default rules to ensure proper enforcement without affecting system files.



### **Step 9 — Enabling AppLocker Rule Enforcement**


<img width="1048" height="737" alt="13" src="https://github.com/user-attachments/assets/e2d215aa-a315-4484-b2ee-e84c8336d7fb" />



<img width="1061" height="778" alt="14" src="https://github.com/user-attachments/assets/dcfa8e7e-e481-4e14-bcc0-c2fa1b45c2ff" />

Ensured all AppLocker rules, including the new rule for `C:\Test`, were actively enforced so that unauthorized executables would be blocked.



### **Step 10 — Testing AppLocker Enforcement on Target Folder**

<img width="1068" height="793" alt="15" src="https://github.com/user-attachments/assets/0a14e455-59e9-4acb-9894-982cf53d5277" />

Validated that the AppLocker rule for `C:\Test` successfully blocked execution of executables, confirming containment of potential malicious files.


**Test Executed:** Attempted to run `test.exe` via File Explorer — successfully blocked by AppLocker.
